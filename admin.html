<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo - SmartBarber</title>
    <style>
        :root { --dorado: #d4af37; --oscuro: #121212; --gris: #1e1e1e; --rojo: #ff4444; --azul: #0099ff; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--oscuro); color: white; padding: 20px; text-align: center; }
        
        .admin-panel {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--dorado);
            padding: 20px;
            border-radius: 15px;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        input, select { padding: 12px; border-radius: 8px; border: 1px solid #444; background: #000; color: white; margin: 5px; width: 80%; }
        button { background: var(--dorado); color: black; border: none; padding: 15px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; width: 85%; margin-top: 10px; text-transform: uppercase; }
        button:hover { background: #b8952d; }
        
        #status { margin-top: 15px; font-weight: bold; color: var(--dorado); }
    </style>
</head>
<body>

    <h1>Panel Administrativo üíà</h1>
    <p>GESTI√ìN DE MIEMBROS</p>

    <div class="admin-panel">
        <h3>‚ûï Registrar Nuevo Miembro</h3>
        <input type="text" id="nuevoNombre" placeholder="Nombre Completo">
        <input type="number" id="nuevoDni" placeholder="DNI (Sin puntos)">
        <select id="nuevoRol">
            <option value="Estudiante">Estudiante</option>
            <option value="Barbero">Barbero</option>
        </select>
        <button onclick="registrarUsuario()">Guardar en Base de Datos</button>
        <div id="status"></div>
    </div>

    <script>
        // TU URL DE GOOGLE APPS SCRIPT
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzdIQm3sITKDmYmMqabIV5D4TMkruS1Qrbj3XIo_Amx6iGfgWWdfwoZ-pc6BodKUvd8Vg/exec";

        async function registrarUsuario() {
            const nombre = document.getElementById('nuevoNombre').value.trim();
            const dni = document.getElementById('nuevoDni').value.trim();
            const rol = document.getElementById('nuevoRol').value;
            const statusDiv = document.getElementById('status');

            if(!nombre || !dni) {
                alert("Por favor, completa Nombre y DNI");
                return;
            }

            statusDiv.innerText = "‚è≥ Guardando en Google Sheets...";

            try {
                // Importante: Enviamos action=add para que el Script sepa que es un registro
                const params = `?action=add&nombre=${encodeURIComponent(nombre)}&dni=${dni}&rol=${rol}&t=${Date.now()}`;
                
                const response = await fetch(WEB_APP_URL + params);
                const data = await response.json();

                if(data.success) {
                    alert("‚úÖ Registrado con √©xito: " + nombre);
                    document.getElementById('nuevoNombre').value = "";
                    document.getElementById('nuevoDni').value = "";
                    statusDiv.innerText = "¬°Registro exitoso!";
                } else {
                    alert("‚ùå Error al guardar.");
                    statusDiv.innerText = "Error en el servidor.";
                }
            } catch (err) {
                // Si hay error de CORS pero los datos llegan al Excel, lo manejamos
                console.log("CORS o Red:", err);
                alert("Petici√≥n enviada. Verific√° tu planilla de Excel en unos segundos.");
                statusDiv.innerText = "Verific√° el Excel.";
            }
        }
    </script>
</body>
</html>
