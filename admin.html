<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - SmartBarber</title>
    <style>
        :root { --dorado: #d4af37; --oscuro: #121212; --gris: #1e1e1e; --rojo: #ff4444; --azul: #0099ff; }
        body { font-family: sans-serif; background-color: var(--oscuro); color: white; padding: 20px; text-align: center; }
        
        .admin-panel {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--dorado);
            padding: 20px;
            border-radius: 15px;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        input, select { padding: 10px; border-radius: 5px; border: 1px solid #444; background: #000; color: white; margin: 5px; }
        button { background: var(--dorado); color: black; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        
        table { width: 100%; max-width: 950px; margin: 0 auto; border-collapse: collapse; background: var(--gris); border-radius: 10px; overflow: hidden; }
        th { background: var(--dorado); color: black; padding: 15px; }
        td { padding: 12px; border-bottom: 1px solid #333; }
        
        .badge-rol { padding: 4px 8px; border-radius: 5px; font-size: 0.75rem; font-weight: bold; text-transform: uppercase; }
        .rol-barbero { background: var(--azul); color: white; }
        .rol-estudiante { background: #444; color: #ccc; }
    </style>
</head>
<body>

    <h1>Panel Administrativo üíà</h1>
    <p style="color: var(--dorado)">GESTI√ìN DE BASE DE DATOS EN TIEMPO REAL</p>

    <div class="admin-panel">
        <h3>‚ûï Registrar Nuevo Miembro</h3>
        <input type="text" id="nuevoNombre" placeholder="Nombre Completo">
        <input type="number" id="nuevoDni" placeholder="DNI">
        <select id="nuevoRol">
            <option value="Estudiante">Estudiante</option>
            <option value="Barbero">Barbero</option>
        </select>
        <button onclick="registrarUsuario()">Guardar en Google Sheets</button>
    </div>

    <div id="status" style="margin-bottom: 10px; color: var(--dorado); font-weight: bold;"></div>

    <script>
        // URL DE TU GOOGLE APPS SCRIPT (LA MISMA QUE USASTE EN EL INDEX)
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzdIQm3sITKDmYmMqabIV5D4TMkruS1Qrbj3XIo_Amx6iGfgWWdfwoZ-pc6BodKUvd8Vg/exec";

        async function registrarUsuario() {
            const nombre = document.getElementById('nuevoNombre').value;
            const dni = document.getElementById('nuevoDni').value;
            const rol = document.getElementById('nuevoRol').value;
            const status = document.getElementById('status');

            if(!nombre || !dni) return alert("Completa nombre y DNI");

            status.innerText = "‚è≥ Guardando en la nube...";

            try {
                // Enviamos los datos a Google Sheets usando modo 'no-cors' para el env√≠o simple
                // O usamos una URL con par√°metros para que el doGet que ya tienes lo procese
                const urlRegistro = `${WEB_APP_URL}?action=add&nombre=${encodeURIComponent(nombre)}&dni=${dni}&rol=${rol}`;
                
                const res = await fetch(urlRegistro);
                const data = await res.json();

                if(data.success || res.ok) {
                    alert(`‚úÖ ${nombre} guardado con √©xito.`);
                    document.getElementById('nuevoNombre').value = "";
                    document.getElementById('nuevoDni').value = "";
                    status.innerText = "¬°Listo!";
                }
            } catch (err) {
                console.error(err);
                // Si da error de CORS pero se guarda igual, avisamos
                alert("Verific√° tu Excel. Si no aparece, es necesario actualizar el Script.");
                status.innerText = "";
            }
        }
    </script>
</body>
</html>
